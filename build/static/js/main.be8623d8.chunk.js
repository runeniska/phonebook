(this.webpackJsonppuhelinluettelo=this.webpackJsonppuhelinluettelo||[]).push([[0],{21:function(e,n,t){},42:function(e,n,t){"use strict";t.r(n);var c=t(2),r=t.n(c),a=t(16),s=t.n(a),u=(t(21),t(3)),o=t(7),i=t(4),l=t.n(i),d="/api/persons",j={getAll:function(){return l.a.get(d).then((function(e){return e.data}))},create:function(e){return l.a.post(d,e).then((function(e){return e.data}))},update:function(e){var n=d+"/"+e.id;return l.a.put(n,e).then((function(e){return e.data}))},del:function(e){var n=d+"/"+e;return l.a.delete(n).then((function(e){return e.data}))}},h=t(0),f=function(e){var n=e.search,t=e.searchNames;return Object(h.jsxs)("div",{children:["Filter shown with ",Object(h.jsx)("input",{value:n,onChange:t})]})},b=function(e){var n=e.persons,t=e.setPersons,c=e.newName,r=e.setNewName,a=e.newNumber,s=e.setNewNumber,u=e.setMessage,i=e.handleNameChange,l=e.handleNumberChange;return Object(h.jsx)("div",{children:Object(h.jsxs)("form",{onSubmit:function(e){e.preventDefault();var i=n.map((function(e){return e.name})).includes(c),l={name:c,number:a};if(i){if(window.confirm("".concat(c," is already added to phonebook, replace the old number with a new one?"))){var d=n.find((function(e){return e.name===c})),h=Object(o.a)(Object(o.a)({},d),{},{number:a});j.update(h).then((function(e){r(""),s(""),t(n.map((function(n){return n.id!==d.id?n:e}))),u("Contact '".concat(d.name,"' was updated successfully")),setTimeout((function(){return u(null)}),5e3)})).catch((function(e){console.log(e),u("Information of '".concat(d.name,"' has already been removed from server")),setTimeout((function(){return u(null)}),5e3),t(n.filter((function(e){return e.id!==d.id})))}))}}else j.create(l).then((function(e){r(""),s(""),t(n.concat(e)),u("Contact '".concat(l.name,"' was added successfully")),setTimeout((function(){return u(null)}),5e3)})).catch((function(e){console.log(e.response.data),u("".concat(e.response.data.error)),setTimeout((function(){return u(null)}),1e4)}))},children:[Object(h.jsxs)("div",{children:["name: ",Object(h.jsx)("input",{value:c,onChange:i})]}),Object(h.jsxs)("div",{children:["number: ",Object(h.jsx)("input",{value:a,onChange:l})]}),Object(h.jsx)("div",{children:Object(h.jsx)("button",{type:"submit",children:"add"})})]})})},m=function(e){var n=e.persons,t=e.setPersons,c=e.search,r=e.setMessage,a=n.filter((function(e){return e.name.toLocaleLowerCase().includes(c.toLocaleLowerCase())}));return Object(h.jsx)("div",{children:Object(h.jsx)("ul",{children:a.map((function(e){return Object(h.jsxs)("li",{children:[e.name," ",e.number," ",Object(h.jsx)("button",{onClick:function(){return function(e){window.confirm("Delete ".concat(e.name,"?"))&&(j.del(e.id).then((function(n){r("Contact '".concat(e.name,"' was removed successfully")),setTimeout((function(){return r(null)}),5e3)})).catch((function(n){return console.log("".concat(e.name," is removed already"))})),t(n.filter((function(n){return n.id!==e.id}))))}(e)},children:"delete"})]},e.name)}))})})},O=function(e){var n=e.message;return n?n.includes("success")?Object(h.jsx)("div",{className:"success",children:n}):Object(h.jsx)("div",{className:"error",children:n}):null},v=function(){var e=Object(c.useState)([]),n=Object(u.a)(e,2),t=n[0],r=n[1],a=Object(c.useState)(""),s=Object(u.a)(a,2),o=s[0],i=s[1],l=Object(c.useState)(""),d=Object(u.a)(l,2),v=d[0],p=d[1],x=Object(c.useState)(""),g=Object(u.a)(x,2),w=g[0],N=g[1],C=Object(c.useState)(""),y=Object(u.a)(C,2),S=y[0],k=y[1];return Object(c.useEffect)((function(){j.getAll().then((function(e){return r(e)})).catch((function(e){return console.log("Cannot fetch contacts from server")}))}),[]),Object(h.jsxs)("div",{children:[Object(h.jsx)("h2",{children:"Phonebook"}),Object(h.jsx)(O,{message:S}),Object(h.jsx)(f,{search:w,searchNames:function(e){return N(e.target.value)}}),Object(h.jsx)("h2",{children:"Add new contact"}),Object(h.jsx)(b,{persons:t,setPersons:r,newName:o,setNewName:i,newNumber:v,setNewNumber:p,setMessage:k,handleNameChange:function(e){return i(e.target.value)},handleNumberChange:function(e){return p(e.target.value)}}),Object(h.jsx)("h2",{children:"Numbers"}),Object(h.jsx)(m,{persons:t,setPersons:r,search:w,setMessage:k})]})};s.a.render(Object(h.jsx)(r.a.StrictMode,{children:Object(h.jsx)(v,{})}),document.getElementById("root"))}},[[42,1,2]]]);
//# sourceMappingURL=main.be8623d8.chunk.js.map